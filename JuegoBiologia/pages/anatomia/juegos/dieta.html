<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>ü•ó Maestros de la Dieta</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  :root{
    --bg1:#43a047; /* green */
    --bg2:#1e88e5; /* blue */
    --card: rgba(255,255,255,0.15);
    --card-strong: rgba(255,255,255,0.25);
    --text:#ffffff;
    --accent:#ffd54f;
    --accent-2:#90caf9;
    --ok:#c8e6c9;
    --bad:#ffcdd2;
    --shadow: 0 10px 25px rgba(0,0,0,0.2);
    --round:16px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell, Noto Sans, Arial, sans-serif;
    background: linear-gradient(135deg, var(--bg1), var(--bg2));
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  header{
    position:sticky; top:0; z-index:10;
    display:flex; align-items:center; justify-content:space-between;
    padding:12px 16px; background:rgba(0,0,0,0.25); backdrop-filter: blur(6px);
  }
  header h1{margin:0; font-size:1.25rem}
  header .nav-btn{
    border:none; border-radius:999px; padding:10px 14px; background:var(--accent-2); color:#003366; font-weight:700;
    box-shadow:var(--shadow); cursor:pointer;
  }
  .container{padding:18px; max-width:1100px; margin:0 auto;}
  .grid{
    display:grid; gap:16px;
    grid-template-columns: repeat(12, 1fr);
  }
  .card{
    background:var(--card); border-radius:var(--round); padding:16px; box-shadow:var(--shadow);
  }
  .menu-card{
    grid-column: span 12;
    display:flex; align-items:center; gap:12px; cursor:pointer;
    transition: transform .15s ease, background .3s;
    padding:18px;
  }
  .menu-card:hover{transform: translateY(-3px); background:var(--card-strong)}
  .menu-card .emoji{font-size:2.2rem}
  .menu-card h3{margin:0 0 6px; font-size:1.2rem}
  .menu-card p{margin:0; opacity:.95; font-size:0.98rem}
  @media(min-width:640px){ .menu-card{grid-column: span 6;} }
  @media(min-width:980px){ .menu-card{grid-column: span 3;} }

  .btn{
    display:inline-block; border:none; border-radius:12px; padding:12px 16px; background:var(--accent);
    color:#222; font-weight:700; cursor:pointer; box-shadow:var(--shadow);
  }
  .btn.secondary{ background:var(--accent-2); color:#003366}
  .btn.ghost{ background:transparent; border:2px solid rgba(255,255,255,.5); color:#fff}
  .toolbar{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-bottom:12px;}
  .pill{background:rgba(0,0,0,.3); padding:6px 10px; border-radius:999px; font-size:.95rem}
  .feedback{font-weight:700; margin-top:10px}
  .ok{ color: var(--ok);}
  .bad{ color: var(--bad);}

  /* Hide sections by default; showSection will toggle 'hidden' class */
  section { display: none; }

  /* --- MEMORIA --- */
  #memoria-board{
    display:grid; gap:10px; margin-top:12px;
    grid-template-columns: repeat(4, 1fr);
  }
  @media(min-width:780px){ #memoria-board{ grid-template-columns: repeat(5, 1fr);} }
  .card-mem{
    background:rgba(255,255,255,.1); border-radius:14px; min-height:84px; display:flex; align-items:center; justify-content:center;
    font-weight:700; text-align:center; padding:10px; cursor:pointer; user-select:none; position:relative; transition: transform .15s;
  }
  .card-mem.flipped, .card-mem.matched{ background:rgba(255,255,255,.92); color:#222;}
  .card-mem.matched{ outline:3px solid rgba(255,255,255,.8)}
  .legend{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; font-size:.9rem; opacity:.95}

  /* --- DRAG & DROP --- */
  #drag-area{ display:grid; gap:14px; grid-template-columns: 1fr; }
  @media(min-width:900px){ #drag-area{ grid-template-columns: 1fr 1fr; } }
  .drag-pool, .drop-cols{ background:var(--card-strong); border-radius:var(--round); padding:14px;}
  .pool-items{ display:flex; flex-wrap:wrap; gap:8px; }
  .food{
    background:#fff; color:#333; border-radius:999px; padding:8px 12px; box-shadow:var(--shadow);
    display:flex; align-items:center; gap:6px; cursor:grab; touch-action:none;
    user-select:none;
  }
  .food.dragging{ opacity:.7; transform:scale(.98)}
  .drop-cols{ display:grid; gap:12px; grid-template-columns: repeat(2, 1fr); }
  @media(min-width:620px){ .drop-cols{ grid-template-columns: repeat(3, 1fr);} }
  .dropzone{
    background:rgba(0,0,0,.15); border:2px dashed rgba(255,255,255,.45); border-radius:12px; padding:10px; min-height:110px;
  }
  .dropzone h4{ margin:0 0 8px 0}
  .slot{ display:flex; flex-wrap:wrap; gap:6px;}
  .mini{ font-size:.85rem; }
  .tap-tip{ font-size:.9rem; opacity:.85; margin-top:8px}

  /* --- CASOS --- */
  .case-wrap{
    display:flex; flex-wrap:wrap; gap:16px;
  }
  .case-text{
    flex:1; min-width:260px; background:var(--card-strong); border-radius:var(--round); padding:14px;
  }
  .case-opts{ flex:1; min-width:260px; display:flex; flex-direction:column; gap:10px}
  .case-opts .btn{ width:100%; text-align:center}

  /* --- QUIZ --- */
  .qbox{ background:var(--card); border-radius:var(--round); padding:16px; }
  .qopts{ display:flex; flex-direction:column; gap:10px; margin-top:10px}
  .scorebox{ background:rgba(0,0,0,.35); border-radius:999px; padding:8px 14px; display:inline-flex; gap:10px; align-items:center }

  /* small screens */
  @media (max-width:520px){
    header h1{font-size:1rem}
    .menu-card{padding:14px}
    .menu-card .emoji{font-size:1.6rem}
  }
</style>
</head>
<body>

<header>
  <h1>ü•ó Maestros de la Dieta</h1>
  <div style="display:flex; gap:8px; align-items:center">
    <button class="nav-btn" onclick="showSection('menu')">üè† Men√∫</button>
  </div>
</header>

<div class="container">

  <!-- ================== MEN√ö ================== -->
  <section id="menu" aria-label="Men√∫ principal">
    <div class="grid">
      <div class="menu-card card" onclick="startMemoria()" role="button" tabindex="0">
        <div class="emoji">üß†</div>
        <div>
          <h3>Memoria Nutricional</h3>
          <p>Empareja nutriente ‚Üî funci√≥n (10 pares). Colores por pareja.</p>
        </div>
      </div>

      <div class="menu-card card" onclick="startDragDrop()" role="button" tabindex="0">
        <div class="emoji">ü•¶</div>
        <div>
          <h3>Clasificaci√≥n de Alimentos</h3>
          <p>Arrastra ~40 alimentos a su categor√≠a. Tambi√©n puedes tocar para asignar.</p>
        </div>
      </div>

      <div class="menu-card card" onclick="startCasos()" role="button" tabindex="0">
        <div class="emoji">üßë‚Äç‚öïÔ∏è</div>
        <div>
          <h3>Casos de Dieta Saludable</h3>
          <p>10 casos narrados con emojis. Elige la mejor recomendaci√≥n.</p>
        </div>
      </div>

      <div class="menu-card card" onclick="startQuiz()" role="button" tabindex="0">
        <div class="emoji">üéØ</div>
        <div>
          <h3>Reto Final (Quiz)</h3>
          <p>Preguntas generales aleatorias. Nota de 0 a 20.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ================== MEMORIA ================== -->
  <section id="memoria" aria-label="Memoria nutricional">
    <div class="toolbar">
      <span class="pill">Pares encontrados: <b id="mem-found">0</b>/10</span>
      <div style="margin-left:auto; display:flex; gap:8px;">
        <button class="btn secondary" onclick="startMemoria()">üîÑ Reiniciar</button>
        <button class="btn ghost" onclick="showSection('menu')">üîô Volver al men√∫</button>
      </div>
    </div>
    <div id="memoria-board"></div>
    <div class="legend" id="mem-legend"></div>
  </section>

  <!-- ================== DRAG & DROP ================== -->
  <section id="drag" aria-label="Clasificaci√≥n de alimentos">
    <div class="toolbar">
      <span class="pill">Correctos: <b id="drag-correct">0</b></span>
      <span class="pill">Clasificados: <b id="drag-done">0</b>/40</span>
      <div style="margin-left:auto; display:flex; gap:8px;">
        <button class="btn secondary" onclick="startDragDrop()">üîÑ Reiniciar</button>
        <button class="btn ghost" onclick="showSection('menu')">üîô Volver al men√∫</button>
      </div>
    </div>
    <div id="drag-area">
      <div class="drag-pool card">
        <h3>üß∫ Alimentos para clasificar</h3>
        <div class="tap-tip">Sugerencia m√≥vil: toca un alimento y luego toca una categor√≠a para asignarlo.</div>
        <div id="pool" class="pool-items" style="margin-top:10px"></div>
      </div>
      <div class="drop-cols card" style="padding-top:22px;">
        <div class="dropzone" data-cat="Carbohidratos">
          <h4>üçû Carbohidratos</h4>
          <div class="slot" id="slot-Carbohidratos"></div>
        </div>
        <div class="dropzone" data-cat="Prote√≠nas">
          <h4>üçó Prote√≠nas</h4>
          <div class="slot" id="slot-Prote√≠nas"></div>
        </div>
        <div class="dropzone" data-cat="Grasas">
          <h4>ü•ë Grasas</h4>
          <div class="slot" id="slot-Grasas"></div>
        </div>
        <div class="dropzone" data-cat="Vitaminas">
          <h4>üçä Vitaminas</h4>
          <div class="slot" id="slot-Vitaminas"></div>
        </div>
        <div class="dropzone" data-cat="Minerales">
          <h4>üßÇ Minerales</h4>
          <div class="slot" id="slot-Minerales"></div>
        </div>
      </div>
    </div>
    <div id="drag-feedback" class="feedback"></div>
  </section>

  <!-- ================== CASOS ================== -->
  <section id="casos" aria-label="Casos de dieta saludable">
    <div class="toolbar">
      <span class="pill">Caso <b id="case-num">0</b>/10</span>
      <span class="pill">Aciertos: <b id="case-ok">0</b></span>
      <div style="margin-left:auto; display:flex; gap:8px;">
        <button class="btn secondary" onclick="startCasos()">üîÑ Reiniciar</button>
        <button class="btn ghost" onclick="showSection('menu')">üîô Volver al men√∫</button>
      </div>
    </div>
    <div class="case-wrap">
      <div class="case-text" id="case-text">Selecciona para comenzar‚Ä¶</div>
      <div class="case-opts" id="case-opts"></div>
    </div>
    <div id="case-feedback" class="feedback"></div>
  </section>

  <!-- ================== QUIZ ================== -->
  <section id="quiz" aria-label="Reto final">
    <div class="toolbar">
      <span class="scorebox">
        <span>Pregunta <b id="q-num">0</b>/10</span>
        <span>| Nota: <b id="q-score">0</b>/20</span>
      </span>
      <div style="margin-left:auto; display:flex; gap:8px;">
        <button class="btn secondary" onclick="startQuiz()">üîÑ Reiniciar</button>
        <button class="btn ghost" onclick="showSection('menu')">üîô Volver al men√∫</button>
      </div>
    </div>
    <div class="qbox" id="q-box"></div>
    <div class="feedback" id="q-feedback"></div>
  </section>

</div>

<script>
/* ----------------------- UTIL ----------------------- */
function showSection(id){
  // oculta todas las secciones y muestra solo la seleccionada
  const sections = ['menu','memoria','drag','casos','quiz'];
  for(const s of sections){
    const el = document.getElementById(s);
    if(el) el.style.display = (s === id) ? 'block' : 'none';
  }
  // limpiar feedbacks cada vez que entramos
  const fids = ['drag-feedback','case-feedback','q-feedback'];
  fids.forEach(fid => { const el=document.getElementById(fid); if(el) el.innerHTML=''; });
}

/* shuffle util */
function shuffle(arr){
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}

/* =====================================================
   =============== 1) MEMORIA NUTRICIONAL ==============
   ===================================================== */

const MEM_PAIRS = [
  {name:'Carbohidratos', func:'Energ√≠a inmediata (4 kcal/g).', color:'#bbdefb'},
  {name:'Prote√≠nas', func:'Construcci√≥n y reparaci√≥n de tejidos (4 kcal/g).', color:'#c8e6c9'},
  {name:'Grasas', func:'Reserva energ√©tica y hormonas (9 kcal/g).', color:'#ffe0b2'},
  {name:'Fibra', func:'Mejora digesti√≥n y saciedad.', color:'#d1c4e9'},
  {name:'Vitamina C', func:'Defensas y cicatrizaci√≥n.', color:'#ffcdd2'},
  {name:'Vitamina A', func:'Visi√≥n y piel.', color:'#fff9c4'},
  {name:'Calcio', func:'Huesos y dientes.', color:'#e1f5fe'},
  {name:'Hierro', func:'Transporte de ox√≠geno (hemoglobina).', color:'#f8bbd0'},
  {name:'Agua', func:'Hidrataci√≥n y transporte de nutrientes.', color:'#b3e5fc'},
  {name:'Omega-3', func:'Salud cardiovascular y cerebro.', color:'#c5e1a5'},
];

let memFirst=null, memLock=false, memFound=0;

function startMemoria(){
  showSection('memoria');
  const board = document.getElementById('memoria-board');
  const legend = document.getElementById('mem-legend');
  const foundEl = document.getElementById('mem-found');
  board.innerHTML=''; legend.innerHTML=''; foundEl.textContent='0';
  memFirst=null; memLock=false; memFound=0;

  let cards=[];
  MEM_PAIRS.forEach((p,idx)=>{
    cards.push({id:`n-${idx}`, type:'name', text:`${p.name}`, color:p.color});
    cards.push({id:`f-${idx}`, type:'func', text:`${p.func}`, color:p.color});
    const tag=document.createElement('span');
    tag.className='pill';
    tag.style.background=p.color;
    tag.style.color='#222';
    tag.style.padding='6px 8px';
    tag.style.borderRadius='8px';
    tag.textContent=p.name;
    legend.appendChild(tag);
  });
  cards=shuffle(cards);

  cards.forEach(c=>{
    const div=document.createElement('div');
    div.className='card-mem';
    div.dataset.id=c.id;
    div.dataset.color=c.color;
    div.dataset.pair = c.id.split('-')[1];
    div.style.border = `3px solid transparent`;
    div.onclick=()=>memFlip(div, c);
    board.appendChild(div);
  });
}

function memFlip(el, data){
  if(memLock || el.classList.contains('matched')) return;
  el.classList.add('flipped');
  el.style.borderColor = data.color;
  el.textContent = data.text;

  if(!memFirst){ memFirst = el; return; }

  memLock=true;
  const samePair = memFirst.dataset.pair === el.dataset.pair && memFirst!==el;
  if(samePair){
    setTimeout(()=>{
      memFirst.classList.remove('flipped'); el.classList.remove('flipped');
      memFirst.classList.add('matched'); el.classList.add('matched');
      memFirst.style.background = el.style.background = '#fff';
      memFirst.style.color = el.style.color = '#333';
      memFirst = null; memLock=false; memFound++;
      document.getElementById('mem-found').textContent=memFound;
      // si encuentra todas, mensaje breve
      if(memFound===MEM_PAIRS.length){
        setTimeout(()=> alert('üéâ ¬°Encontraste todos los pares!'), 200);
      }
    }, 250);
  } else {
    setTimeout(()=>{
      memFirst.classList.remove('flipped'); el.classList.remove('flipped');
      memFirst.style.borderColor='transparent'; el.style.borderColor='transparent';
      memFirst.textContent=''; el.textContent='';
      memFirst = null; memLock=false;
    }, 700);
  }
}

/* =====================================================
   ============ 2) CLASIFICACI√ìN DRAG & DROP ===========
   ===================================================== */

const FOODS = [
  // Carbohidratos
  {emoji:'üçû', name:'Pan', cat:'Carbohidratos'},
  {emoji:'üçö', name:'Arroz', cat:'Carbohidratos'},
  {emoji:'üçù', name:'Pasta', cat:'Carbohidratos'},
  {emoji:'ü•î', name:'Papa', cat:'Carbohidratos'},
  {emoji:'üåΩ', name:'Ma√≠z', cat:'Carbohidratos'},
  {emoji:'üçå', name:'Pl√°tano', cat:'Carbohidratos'},
  {emoji:'ü•ñ', name:'Baguette', cat:'Carbohidratos'},
  {emoji:'ü´ì', name:'Tortilla', cat:'Carbohidratos'},

  // Prote√≠nas
  {emoji:'üçó', name:'Pollo', cat:'Prote√≠nas'},
  {emoji:'ü•©', name:'Carne', cat:'Prote√≠nas'},
  {emoji:'üêü', name:'Pescado', cat:'Prote√≠nas'},
  {emoji:'ü•ö', name:'Huevo', cat:'Prote√≠nas'},
  {emoji:'ü´ò', name:'Legumbres', cat:'Prote√≠nas'},
  {emoji:'üßÄ', name:'Queso', cat:'Prote√≠nas'},
  {emoji:'ü•õ', name:'Leche', cat:'Prote√≠nas'},
  {emoji:'üå∞', name:'Nueces', cat:'Prote√≠nas'},

  // Grasas
  {emoji:'ü•ë', name:'Palta/Aguacate', cat:'Grasas'},
  {emoji:'ü´í', name:'Aceite de oliva', cat:'Grasas'},
  {emoji:'üßà', name:'Mantequilla', cat:'Grasas'},
  {emoji:'ü•ú', name:'Man√≠', cat:'Grasas'},
  {emoji:'üêü', name:'Salm√≥n graso', cat:'Grasas'},
  {emoji:'üç´', name:'Chocolate', cat:'Grasas'},
  {emoji:'ü•ì', name:'Tocino', cat:'Grasas'},
  {emoji:'ü••', name:'Coco', cat:'Grasas'},

  // Vitaminas
  {emoji:'üçä', name:'Naranja (Vit C)', cat:'Vitaminas'},
  {emoji:'ü•ï', name:'Zanahoria (Vit A)', cat:'Vitaminas'},
  {emoji:'üçì', name:'Fresa (Vit C)', cat:'Vitaminas'},
  {emoji:'ü•¶', name:'Br√≥coli (Vit C/K)', cat:'Vitaminas'},
  {emoji:'üçÖ', name:'Tomate (Vit A/C)', cat:'Vitaminas'},
  {emoji:'ü•¨', name:'Espinaca (√Åcido f√≥lico)', cat:'Vitaminas'},
  {emoji:'üçá', name:'Uvas (Antioxidantes)', cat:'Vitaminas'},
  {emoji:'üçé', name:'Manzana (Vit C)', cat:'Vitaminas'},

  // Minerales
  {emoji:'üßÇ', name:'Sal yodo (Yodo)', cat:'Minerales'},
  {emoji:'ü•õ', name:'Leche (Calcio)', cat:'Minerales'},
  {emoji:'ü•¨', name:'Acelga (Hierro)', cat:'Minerales'},
  {emoji:'üêö', name:'Mariscos (Zinc)', cat:'Minerales'},
  {emoji:'üçå', name:'Pl√°tano (Potasio)', cat:'Minerales'},
  {emoji:'ü•ú', name:'Semillas (Magnesio)', cat:'Minerales'},
  {emoji:'üêü', name:'Pescado (Selenio)', cat:'Minerales'},
  {emoji:'üíß', name:'Agua (Electrolitos)', cat:'Minerales'}
]; // 40 elementos

let dragCorrect=0, dragDone=0, selectedFoodForTap=null;

function startDragDrop(){
  showSection('drag');
  dragCorrect=0; dragDone=0; selectedFoodForTap=null;
  document.getElementById('drag-correct').textContent=dragCorrect;
  document.getElementById('drag-done').textContent=dragDone;

  // limpiar slots
  document.querySelectorAll('.slot').forEach(s=>s.innerHTML='');

  const pool = document.getElementById('pool');
  pool.innerHTML='';
  shuffle(FOODS).forEach((f,idx)=>{
    const chip=document.createElement('div');
    chip.className='food mini';
    chip.textContent = `${f.emoji} ${f.name}`;
    chip.draggable = true;
    chip.dataset.cat = f.cat;
    chip.dataset.id = 'food-'+idx;

    // HTML5 Drag
    chip.addEventListener('dragstart', e=>{
      chip.classList.add('dragging');
      e.dataTransfer.setData('text/plain', JSON.stringify({id:chip.dataset.id, cat:f.cat, label:chip.textContent}));
    });
    chip.addEventListener('dragend', ()=> chip.classList.remove('dragging'));

    // Tap-to-assign fallback
    chip.addEventListener('click', ()=>{
      selectedFoodForTap = chip;
      document.querySelectorAll('.food').forEach(x=>x.style.outline='none');
      chip.style.outline='3px solid #ffeb3b';
      document.getElementById('drag-feedback').innerHTML = `üëâ Toca una categor√≠a para asignar <b>${chip.textContent}</b>`;
    });

    pool.appendChild(chip);
  });

  // Preparar dropzones
  document.querySelectorAll('.dropzone').forEach(zone=>{
    zone.addEventListener('dragover', e=>e.preventDefault());
    zone.addEventListener('drop', e=>{
      e.preventDefault();
      const data = JSON.parse(e.dataTransfer.getData('text/plain'));
      const chip = Array.from(document.querySelectorAll('.food')).find(el=>el.dataset.id===data.id);
      if(!chip) return;
      handleAssign(chip, zone.dataset.cat);
    });

    // soporte tap
    zone.addEventListener('click', ()=>{
      if(selectedFoodForTap){
        handleAssign(selectedFoodForTap, zone.dataset.cat);
        selectedFoodForTap = null;
      }
    });
  });
}

function handleAssign(chip, targetCat){
  const correct = chip.dataset.cat === targetCat;
  dragDone++;
  if(correct) dragCorrect++;

  document.getElementById('drag-correct').textContent=dragCorrect;
  document.getElementById('drag-done').textContent=dragDone;

  // mover chip a la zona
  const slot = document.getElementById('slot-'+targetCat);
  chip.draggable=false;
  chip.style.cursor='default';
  chip.style.outline='none';
  chip.style.background = correct ? '#c8e6c9' : '#ffcdd2';
  chip.title = correct ? 'Correcto' : `Incorrecto (era: ${chip.dataset.cat})`;
  slot.appendChild(chip);

  // feedback
  document.getElementById('drag-feedback').innerHTML = correct
    ? `<span class="ok">‚úÖ Correcto: ${chip.textContent} ‚Üí ${targetCat}</span>`
    : `<span class="bad">‚ùå Incorrecto: ${chip.textContent} ‚Üí ${targetCat}. <br>Respuesta: ${chip.dataset.cat}</span>`;
}

/* =====================================================
   ================= 3) CASOS NARRADOS =================
   ===================================================== */

const CASES = [
  {text:"üëß Mar√≠a es deportista y entrena todos los d√≠as. Antes del entrenamiento necesita energ√≠a r√°pida. ¬øQu√© debe priorizar?",
   options:["Carbohidratos complejos (arroz, pasta)","Vitaminas exclusivamente","Solo grasas"], correct:0,
   exp:"Los carbohidratos aportan energ√≠a inmediata y son clave para rendimiento."},
  {text:"üßë‚Äçüíº Pedro pasa muchas horas sentado y toma mucha gaseosa. Quiere bajar az√∫car. ¬øQu√© cambio es mejor?",
   options:["Cambiar gaseosa por agua y frutas","Comer m√°s grasas","Evitar verduras"], correct:0,
   exp:"Reducir az√∫car libre y preferir agua/frutas mejora salud y control de peso."},
  {text:"üßë‚Äçüéì Ana est√° an√©mica (bajo hierro). ¬øQu√© alimentos ayudan m√°s?",
   options:["Legumbres y carnes rojas","Fideos blancos","Mantequilla"], correct:0,
   exp:"Hierro hemo (carnes) y no hemo (legumbres); Vitamina C mejora su absorci√≥n."},
  {text:"üëµ Rosa tiene osteoporosis. ¬øQu√© debe priorizar?",
   options:["Calcio + vitamina D","Solo carbohidratos","Grasas saturadas"], correct:0,
   exp:"Calcio y vitamina D favorecen la salud √≥sea."},
  {text:"üßë‚Äçüç≥ Luis es vegetariano y busca prote√≠na de calidad.",
   options:["Legumbres, tofu, quinoa","Tocino","Solo harinas"], correct:0,
   exp:"Hay prote√≠nas vegetales completas o combinaciones que cubren amino√°cidos."},
  {text:"üèÉ Carla correr√° una marat√≥n. En la semana previa, ¬øqu√© enfoque es adecuado?",
   options:["Cargar carbohidratos y buena hidrataci√≥n","Comer solo prote√≠nas","Eliminar frutas"], correct:0,
   exp:"Aumentar gluc√≥geno muscular y agua favorece resistencia."},
  {text:"üßë‚Äç‚öïÔ∏è Diego tiene colesterol alto. ¬øQu√© grasas debe preferir?",
   options:["Insaturadas (aceite de oliva, frutos secos)","Trans y saturadas","Grasas de frituras"], correct:0,
   exp:"Grasas insaturadas ayudan al perfil lip√≠dico."},
  {text:"üë∂ Un ni√±o en crecimiento necesita‚Ä¶",
   options:["Prote√≠nas, calcio y energ√≠a suficientes","Solo vitaminas","Solo grasas"], correct:0,
   exp:"Combinar macro y micro (prote√≠nas y calcio) con energ√≠a para crecer."},
  {text:"ü§í Laura se resfr√≠a con frecuencia. ¬øQu√© podr√≠a ayudar?",
   options:["Vitamina C y A de frutas/verduras","M√°s az√∫car","Menos agua"], correct:0,
   exp:"Vitaminas ayudan a la funci√≥n inmune; hidrataci√≥n tambi√©n es clave."},
  {text:"üò¥ Mart√≠n est√° cansado y casi no desayuna. ¬øQu√© h√°bito mejorar?",
   options:["Desayuno con carbohidratos integrales + prote√≠na","Saltar comidas","Solo caf√©"], correct:0,
   exp:"Desayuno balanceado estabiliza energ√≠a y atenci√≥n."}
];

let caseIndex=0, caseOk=0;
function startCasos(){
  showSection('casos');
  caseIndex=0; caseOk=0;
  document.getElementById('case-ok').textContent=caseOk;
  document.getElementById('case-num').textContent=0;
  nextCase();
}
function nextCase(){
  const total=10;
  if(caseIndex>=total){
    document.getElementById('case-text').innerHTML = `<h3>üéâ ¬°Terminaste los 10 casos!</h3><p>Puedes reiniciar o volver al men√∫.</p>`;
    document.getElementById('case-opts').innerHTML = `<button class="btn secondary" onclick="startCasos()">üîÑ Reiniciar</button>`;
    return;
  }
  const c = CASES[caseIndex % CASES.length];
  document.getElementById('case-num').textContent = (caseIndex+1);
  document.getElementById('case-text').innerHTML = `<p>${c.text}</p>`;
  const opts = document.getElementById('case-opts');
  opts.innerHTML='';
  c.options.forEach((opt,i)=>{
    const b=document.createElement('button');
    b.className='btn';
    b.textContent=opt;
    b.onclick=()=>{
      const fb=document.getElementById('case-feedback');
      if(i===c.correct){ caseOk++; fb.innerHTML=`<span class="ok">‚úÖ Correcto:</span> ${c.exp}`; }
      else{ fb.innerHTML=`<span class="bad">‚ùå Incorrecto:</span> ${c.exp}`; }
      document.getElementById('case-ok').textContent=caseOk;
      caseIndex++;
      setTimeout(()=>{ fb.innerHTML=''; nextCase(); }, 1600);
    };
    opts.appendChild(b);
  });
}

/* =====================================================
   =================== 4) QUIZ GENERAL =================
   ===================================================== */

const QUIZ_BANK = [
  {q:"üçû ¬øCu√°l es la principal fuente de energ√≠a inmediata?", options:["Carbohidratos","Prote√≠nas","Grasas"], answer:"Carbohidratos", exp:"Los carbohidratos son energ√≠a r√°pida (4 kcal/g)."},
  {q:"üçó ¬øQu√© nutriente construye y repara tejidos?", options:["Prote√≠nas","Vitaminas","Grasas"], answer:"Prote√≠nas", exp:"Las prote√≠nas forman m√∫sculos, enzimas, etc."},
  {q:"ü•ë ¬øCu√°l aporta 9 kcal/g y sirve como reserva energ√©tica?", options:["Grasas","Carbohidratos","Minerales"], answer:"Grasas", exp:"Las grasas son la reserva densa en energ√≠a."},
  {q:"üíß Funci√≥n clave del agua:", options:["Hidrataci√≥n y transporte","Energ√≠a directa","Formar huesos"], answer:"Hidrataci√≥n y transporte", exp:"Agua transporta nutrientes y regula temperatura."},
  {q:"üçä La vitamina C ayuda principalmente en:", options:["Defensas y cicatrizaci√≥n","Visi√≥n nocturna","Contracci√≥n muscular"], answer:"Defensas y cicatrizaci√≥n", exp:"Vitamina C apoya sistema inmune y col√°geno."},
  {q:"ü¶¥ ¬øQu√© mineral es clave para huesos y dientes?", options:["Calcio","Hierro","Zinc"], answer:"Calcio", exp:"Calcio fortalece la estructura √≥sea."},
  {q:"ü©∏ ¬øCu√°l mineral transporta ox√≠geno en la sangre?", options:["Hierro","Sodio","Potasio"], answer:"Hierro", exp:"Hierro integra la hemoglobina."},
  {q:"üçäüçì Fuentes ricas en vitamina C:", options:["C√≠tricos y fresas","Carnes grasas","Mantequilla"], answer:"C√≠tricos y fresas", exp:"Frutas y verduras ricas en vit. C."},
  {q:"ü´ò Una buena prote√≠na vegetal es:", options:["Legumbres","Az√∫car","Aceite"], answer:"Legumbres", exp:"Legumbres aportan prote√≠na y fibra."},
  {q:"ü´í Para un coraz√≥n sano, preferir:", options:["Grasas insaturadas","Grasas trans","Exceso de az√∫car"], answer:"Grasas insaturadas", exp:"Aceite de oliva, frutos secos, pescado."},
  {q:"üèÉ Deportista antes de entrenar prioriza:", options:["Carbohidratos","Vitaminas","Grasas trans"], answer:"Carbohidratos", exp:"Energ√≠a inmediata para el ejercicio."},
  {q:"üçé La fibra ayuda a:", options:["Digesti√≥n y saciedad","Aumentar az√∫car r√°pida","Deshidratarse"], answer:"Digesti√≥n y saciedad", exp:"Mejora tr√°nsito intestinal y controla apetito."},
  {q:"ü•¶ Una comida equilibrada suele incluir:", options:["Verduras, prote√≠na y carbohidratos integrales","Solo carbohidratos","Solo grasas"], answer:"Verduras, prote√≠na y carbohidratos integrales", exp:"Balance de macro y micro nutrientes."},
  {q:"‚òÄÔ∏è La vitamina D se obtiene tambi√©n de:", options:["Exposici√≥n moderada al sol","Exceso de az√∫car","Sal"], answer:"Exposici√≥n moderada al sol", exp:"La piel sintetiza vitamina D con el sol."},
  {q:"ü•§ Para reducir az√∫car libre se recomienda:", options:["Agua en lugar de gaseosa","M√°s jugos azucarados","M√°s postres"], answer:"Agua en lugar de gaseosa", exp:"Agua es la mejor bebida diaria."},
  {q:"ü•ö Un alimento rico en prote√≠na animal:", options:["Huevo","Pan","Aceite"], answer:"Huevo", exp:"Huevo contiene prote√≠na de alto valor biol√≥gico."},
  {q:"ü•ó Dieta mediterr√°nea destaca por:", options:["Aceite de oliva, frutas, verduras y pescado","Muchos ultraprocesados","Solo carnes rojas"], answer:"Aceite de oliva, frutas, verduras y pescado", exp:"Patr√≥n saludable y variado."},
  {q:"üßÇ Exceso de sodio puede causar:", options:["Hipertensi√≥n","Anemia","Raquitismo"], answer:"Hipertensi√≥n", exp:"Moderar la sal ayuda a la presi√≥n arterial."},
  {q:"üç¨ Consumir mucho az√∫car se asocia a:", options:["Obesidad y caries","Mejor rendimiento","M√°s vitaminas"], answer:"Obesidad y caries", exp:"Az√∫car libre en exceso perjudica salud."},
  {q:"ü•î La papa pertenece a:", options:["Carbohidratos","Prote√≠nas","Grasas"], answer:"Carbohidratos", exp:"Fuente de carbohidratos complejos."},
  {q:"ü•õ La leche aporta principalmente:", options:["Prote√≠na y calcio","Az√∫car libre","Grasas trans"], answer:"Prote√≠na y calcio", exp:"Valiosa para huesos y crecimiento."},
  {q:"ü•ú Las nueces aportan:", options:["Grasas saludables y prote√≠na","Solo az√∫car","Solo agua"], answer:"Grasas saludables y prote√≠na", exp:"Tambi√©n minerales y fibra."}
];

let qIndex=0, qCorrect=0, quizOrder=[];

function startQuiz(){
  showSection('quiz');
  qIndex=0; qCorrect=0;
  quizOrder = shuffle(QUIZ_BANK).slice(0,10);
  document.getElementById('q-num').textContent='0';
  document.getElementById('q-score').textContent='0';
  document.getElementById('q-feedback').innerHTML='';
  nextQuizQ();
}
function nextQuizQ(){
  if(qIndex>=10){
    const note = Math.round((qCorrect/10)*20);
    const msg = note>=18 ? "‚ú® ¬°Excelente, maestro de la dieta!" : note>=12 ? "üí™ ¬°Bien! Puedes mejorar un poco m√°s." : "üìò A repasar y volver a intentar.";
    document.getElementById('q-box').innerHTML =
      `<h3>üéâ Ronda terminada</h3>
       <p>Nota: <b>${note}/20</b></p>
       <p>${msg}</p>
       <button class="btn secondary" onclick="startQuiz()">üîÑ Jugar de nuevo</button>`;
    return;
  }
  const item = quizOrder[qIndex];
  document.getElementById('q-num').textContent = (qIndex+1);
  const box = document.getElementById('q-box');
  box.innerHTML = `<h3>${item.q}</h3><div id="qopts" class="qopts"></div>`;
  const opts = document.getElementById('qopts');
  const shuffled = shuffle(item.options);
  shuffled.forEach((opt, i)=>{
    const b=document.createElement('button');
    b.className='btn';
    b.textContent=opt;
    b.onclick=()=>{
      const fb=document.getElementById('q-feedback');
      const isCorrect = opt===item.answer;
      if(isCorrect){ qCorrect++; fb.innerHTML=`<span class="ok">‚úÖ Correcto:</span> ${item.exp}`; }
      else{ fb.innerHTML=`<span class="bad">‚ùå Incorrecto:</span> ${item.exp}`; }
      document.getElementById('q-score').textContent = Math.round((qCorrect/10)*20);
      qIndex++;
      setTimeout(()=>{ fb.innerHTML=''; nextQuizQ(); }, 1400);
    };
    opts.appendChild(b);
  });
}

/* -------------------- INICIO -------------------- */
showSection('menu');
</script>

</body>
</html>


